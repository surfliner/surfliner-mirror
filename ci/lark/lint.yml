lark-lint:
  stage: lint
  image: $CI_REGISTRY_IMAGE/lark_web:$CI_COMMIT_REF_NAME
  script:
    - cd lark
    - bundle check || bundle
    - bundle exec rubocop
  extends: .only-refs-default
  only:
    changes:
      - .gitlab-ci.yml
      - .styles/**/*
      - lark/**/*

lark-client-lint:
  stage: lint
  # reuse the lark_web image; ruby alpine images are missing system dependencies
  image: $CI_REGISTRY_IMAGE/lark_web:$CI_COMMIT_REF_NAME
  script:
    - cd lark-client
    - bundle check || bundle
    - bundle exec rubocop
  extends: .only-refs-default
  only:
    changes:
      - .gitlab-ci.yml
      - ci/lark/**/*
      - .styles/**/*
      - lark-client/**/*
