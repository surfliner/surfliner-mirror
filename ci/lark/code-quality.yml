lark-code-quality:
  stage: test
  image: docker:$DOCKER_IMAGE_VERSION
  variables:
    DOCKER_DRIVER: overlay2
  services:
    - docker:$DOCKER_IMAGE_VERSION-dind
  script:
    - setup_docker
    - code_quality "lark"
  artifacts:
    reports:
      codequality: lark/gl-code-quality-report.json
  extends: .only-refs-default
  only:
    changes:
      - lark/**/*
      - ci/lark/**/*
  except:
    variables:
      - $CODE_QUALITY_DISABLED
