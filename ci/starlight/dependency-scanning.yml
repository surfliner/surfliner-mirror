starlight-dependency-scanning:
  stage: test
  image: docker:stable
  allow_failure: true
  services:
    - docker:stable-dind
  script:
    - setup_docker
    - cd starlight
    - dependency_scanning
  artifacts:
    reports:
      dependency_scanning: starlight/gl-dependency-scanning-report.json
  only:
    changes:
      - starlight/**/*
    variables:
      - $GITLAB_FEATURES =~ /\bdependency_scanning\b/
  except:
    variables:
      - $DEPENDENCY_SCANNING_DISABLED
