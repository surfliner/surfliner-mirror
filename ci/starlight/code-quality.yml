starlight-code-quality:
  stage: test
  image: docker:stable
  variables:
    DOCKER_DRIVER: overlay2
  services:
    - docker:stable-dind
  script:
    - setup_docker
    - code_quality "starlight"
  artifacts:
    reports:
      codequality: starlight/gl-code-quality-report.json
  extends: .only-refs-default
  only:
    changes:
      - starlight/**/*
  except:
    variables:
      - $CODE_QUALITY_DISABLED
