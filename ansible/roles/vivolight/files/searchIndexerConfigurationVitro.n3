@prefix : <http://vitro.mannlib.cornell.edu/ns/vitro/ApplicationSetup#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix searchIndex: <java:edu.cornell.mannlib.vitro.webapp.searchindex#> .


#
# configure the SearchIndexer
#

# Individuals with these types will be excluded from the search index
:searchExcluder_typeExcluder
    a   searchIndex:exclusions.ExcludeBasedOnType ,
        searchIndex:exclusions.SearchIndexExcluder ;
    :excludes
        "http://www.w3.org/2002/07/owl#AnnotationProperty" ,
        "http://www.w3.org/2002/07/owl#DatatypeProperty" ,
        "http://www.w3.org/2002/07/owl#ObjectProperty" .

# Individuals with types from these namespaces will be excluded from the search index.
:searchExcluder_namespaceExcluder
    a   searchIndex:exclusions.ExcludeBasedOnNamespace ,
        searchIndex:exclusions.SearchIndexExcluder ;
    :excludes
        "http://vitro.mannlib.cornell.edu/ns/vitro/0.7#" ,
        "http://vitro.mannlib.cornell.edu/ns/vitro/public#" ,
        "http://vitro.mannlib.cornell.edu/ns/bnode#" ,
        "http://www.w3.org/2002/07/owl#" .

# Individuals with URIs in these namespaces will be excluded from the search index.
:searchExcluder_typeNamespaceExcluder
    a   searchIndex:exclusions.ExcludeBasedOnTypeNamespace ,
        searchIndex:exclusions.SearchIndexExcluder ;
    :excludes
        "http://vitro.mannlib.cornell.edu/ns/vitro/role#public" .

:searchExcluder_syncingTypeExcluder
    a   searchIndex:exclusions.SyncingExcludeBasedOnType ,
        searchIndex:exclusions.SearchIndexExcluder .

# ------------------------------------

:uriFinder_forDataProperties
    a   searchIndex:indexing.IndexingUriFinder ,
        searchIndex:indexing.AdditionalURIsForDataProperties .

:uriFinder_forObjectProperties
    a   searchIndex:indexing.IndexingUriFinder ,
        searchIndex:indexing.AdditionalURIsForObjectProperties .

:uriFinder_forTypeStatements
    a   searchIndex:indexing.IndexingUriFinder ,
        searchIndex:indexing.AdditionalURIsForTypeStatements .

:uriFinder_forClassGroupChange
    a   searchIndex:indexing.IndexingUriFinder ,
        searchIndex:indexing.URIsForClassGroupChange .

# ------------------------------------

:documentModifier_AllNames
    a   searchIndex:documentBuilding.SelectQueryDocumentModifier ,
        searchIndex:documentBuilding.DocumentModifier ;
    rdfs:label "All labels are added to name fields." ;
    :hasTargetField "nameRaw" ;
    :hasSelectQuery """
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
    SELECT ?label
    WHERE {
      ?uri rdfs:label ?label .
      }
        """ .

:documentModifier_name_label
    a   searchIndex:documentBuilding.SelectQueryDocumentModifier ,
        searchIndex:documentBuilding.DocumentModifier ;
    :hasTargetField "name_label" ;
    :hasSelectQuery """
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
    SELECT DISTINCT ?label
    WHERE {
      ?uri rdfs:label ?label .
    }
        """ .

:documentModifier_type_label
    a   searchIndex:documentBuilding.SelectQueryDocumentModifier ,
        searchIndex:documentBuilding.DocumentModifier ;
    :hasTargetField "type_label" ;
    :hasSelectQuery """
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX vitro: <http://vitro.mannlib.cornell.edu/ns/vitro/0.7#>
    SELECT ?title
    WHERE {
      ?uri vitro:mostSpecificType ?type .
      ?type rdfs:label ?title .
    }
        """ .

:documentModifier_position
    a   searchIndex:documentBuilding.SelectQueryDocumentModifier ,
        searchIndex:documentBuilding.DocumentModifier ;
    :hasTargetField "position" ;
    :hasSelectQuery """
        PREFIX vivo: <http://vivoweb.org/ontology/core#>
    SELECT ?position
    WHERE {
      ?position a vivo:Position .
      ?position vivo:relates ?uri .
    }
        """ .

:documentModifier_position_label
    a   searchIndex:documentBuilding.SelectQueryDocumentModifier ,
        searchIndex:documentBuilding.DocumentModifier ;
    :hasTargetField "position_label" ;
    :hasSelectQuery """
        PREFIX vivo: <http://vivoweb.org/ontology/core#>
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
    SELECT ?label
    WHERE {
      ?position a vivo:Position .
      ?position vivo:relates ?uri .
      ?position rdfs:label ?label .
    }
        """ .

:documentModifier_position_start_label
    a   searchIndex:documentBuilding.SelectQueryDocumentModifier ,
        searchIndex:documentBuilding.DocumentModifier ;
    :hasTargetField "position_start_label" ;
    :hasSelectQuery """
        PREFIX vivo: <http://vivoweb.org/ontology/core#>
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
    select ?start
    WHERE {
        ?position a vivo:Position .
        ?position vivo:relates ?uri .
        ?position vivo:dateTimeInterval ?date .
        ?date vivo:start ?time .
        ?time vivo:dateTime ?obj .
        BIND(year(?obj) as ?start) .
    }
        """ .

:documentModifier_position_end_label
    a   searchIndex:documentBuilding.SelectQueryDocumentModifier ,
        searchIndex:documentBuilding.DocumentModifier ;
    :hasTargetField "position_end_label" ;
    :hasSelectQuery """
        PREFIX vivo: <http://vivoweb.org/ontology/core#>
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
    select ?end
    WHERE {
        ?position a vivo:Position .
        ?position vivo:relates ?uri .
        ?position vivo:dateTimeInterval ?date .
        ?date vivo:end ?time .
        ?time vivo:dateTime ?obj .
        BIND(year(?obj) as ?end) .
    }
        """ .

:documentModifier_position_org
    a   searchIndex:documentBuilding.SelectQueryDocumentModifier ,
        searchIndex:documentBuilding.DocumentModifier ;
    :hasTargetField "position_org" ;
    :hasSelectQuery """
        PREFIX foaf: <http://xmlns.com/foaf/0.1/>
        PREFIX vivo: <http://vivoweb.org/ontology/core#>
    SELECT ?org
    WHERE {
      ?position a vivo:Position .
      ?position vivo:relates ?uri .
      ?position vivo:relates ?org .
      ?org a foaf:Organization .
    }
        """ .

:documentModifier_position_org_label
    a   searchIndex:documentBuilding.SelectQueryDocumentModifier ,
        searchIndex:documentBuilding.DocumentModifier ;
    :hasTargetField "position_org_label" ;
    :hasSelectQuery """
        PREFIX foaf: <http://xmlns.com/foaf/0.1/>
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX vivo: <http://vivoweb.org/ontology/core#>
    SELECT ?label
    WHERE {
      ?position a vivo:Position .
      ?position vivo:relates ?uri .
      ?position vivo:relates ?org .
      ?org a foaf:Organization .
      ?org rdfs:label ?label .
    }
        """ .

:documentModifier_url
    a   searchIndex:documentBuilding.SelectQueryDocumentModifier ,
        searchIndex:documentBuilding.DocumentModifier ;
    :hasTargetField "url" ;
    :hasSelectQuery """
        PREFIX vcard: <http://www.w3.org/2006/vcard/ns#>
        PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
    SELECT ?urlString
    WHERE {
      ?uri ?arg ?website .
      ?website vcard:hasURL ?urlObject .
      ?urlObject vcard:url ?url .
      BIND(xsd:string(?url) as ?urlString) .
    }
        """ .

:documentModifier_url_label
    a   searchIndex:documentBuilding.SelectQueryDocumentModifier ,
        searchIndex:documentBuilding.DocumentModifier ;
    :hasTargetField "url_label" ;
    :hasSelectQuery """
        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX vcard:<http://www.w3.org/2006/vcard/ns#>
    SELECT ?label
    WHERE {
      ?uri ?arg ?website .
      ?website vcard:hasURL ?urlObject .
      ?urlObject rdfs:label ?label .
    }
        """ .

:documentModifier_NameFieldBooster
    a   searchIndex:documentBuilding.FieldBooster ,
        searchIndex:documentBuilding.DocumentModifier ;
    :hasTargetField "nameDisplay" ;
    :hasTargetField "nameLowercase" ;
    :hasTargetField "nameRaw" ;
    :hasTargetField "nameStemmed" ;
    :hasTargetField "nameUnstemmed" ;
    :hasTargetField "typeDisplay" ;
    :hasBoost "1.2"^^xsd:float .

:documentModifier_thumbnailImageUrl
    a   searchIndex:documentBuilding.ThumbnailImageURL ,
        searchIndex:documentBuilding.DocumentModifier .
