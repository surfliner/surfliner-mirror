# Deploying Starlight

## Environment Variables

Starlight aims at following the [12 factor application][12-factor] pattern as much as
possible. To that end, there are a set of environment variables that one should
populate when deploying to a staging/production server. Development and test
instances have sane defaults that you should not need to adjust unless you want
to.

How you make these environment variables available during deployment and
application runtime is up to you. You could use an Ansible playbook, Chef,
Puppet, or whatever works best in your local environment and practices.

ENV Variable | Description
------------ | -----------
`BINARY_ROOT` | Mounted share for local file ingestion
`CAP_USER` | User for capistrano to use during deployment
`FROM_EMAIL` | Application email address to use with ActionMailer
`GA_EMAIL` | see [GA section in README](../README.md#google-analytics)
`GA_PKCS12_KEY_PATH` | see [GA section in README](../README.md#google-analytics)
`GA_WEB_PROPERTY_ID` | see [GA section in README](../README.md#google-analytics)
`PORT` | Application port. Generally '3000' for Rails applications
`RAILS_LOG_TO_STDOUT` | Set to any string value if you need to log to stdout
`RAILS_MAX_THREADS` | Maximum size of the database connection pool
`RAILS_QUEUE` | For `production` like environments, use `sidekiq`
`REDIS_URL` | URL of your REDIS instance. E.g. 'localhost:6379'
`SECRET_KEY_BASE` | Can be generated by Ansible scripts.
`SERVER` | Server for capistrano to deploy the starlight application
`SHIB_APPLICATION_ID_FIELD` | E.g. 'Shib-Application-ID'
`SHIB_EMAIL_FIELD` | Shib attribute that contains user email addresses. E.g 'LONG_EMAIL'
`SHIB_SESSION_ID_FIELD` | E.g. 'Shib-Session-ID'
`SHIB_UID_FIELD` | Shib attribute that contains usernames. E.g. 'ADUSERNAME'
`SITEMAP_DEFAULT_HOST` | Hostname for production application. E.g. 'http://localhost'
`SMTP_HOST` | SMPT host for use with ActionMailer. E.g 'localhost'
`SOLR_URL` | URL of your Solr instance. E.g 'http://solr:8983/solr/starlight-core'
`TARGET` | Path for Capistrano to place your application. E.g. '/opt/starlight'

[12-factor]: https://12factor.net/
